<window-config>
    <id>stage-layer</id>
    <title>Layers</title>
    <width>280</width>
    <height>400</height>
    <min-width>200</min-width>
    <min-height>200</min-height>
    <resizable>true</resizable>
</window-config>

<style>
    #stage-layer .window-content {
        background-color: var(--bg-window, #1e1e1e);
        padding: 0;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
    }

    .layer-list {
        flex: 1;
        overflow-y: auto;
        padding: 5px;
        display: flex;
        flex-direction: column;
        gap: 2px;
        position: relative;
    }

    .layer-card {
        display: flex;
        align-items: center;
        background-color: var(--bg-header, #2b2b2b);
        border: 1px solid var(--border-subtle, #383838);
        border-radius: 4px;
        padding: 4px 8px;
        cursor: grab;
        user-select: none;
        /* IMPORTANTE: Transición para que los otros items se muevan suavemente */
        /* Pero la que arrastras se la quitamos en JS */
        height: 36px;
        box-sizing: border-box;
        position: relative;
    }

    .layer-card:hover {
        background-color: var(--bg-hover, #353535);
        border-color: var(--text-muted, #555);
    }
    .layer-card:active { cursor: grabbing; }

    /* Estilos del Placeholder (el hueco) */
    .layer-placeholder {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px dashed #666;
        border-radius: 4px;
        margin-bottom: 2px;
        box-sizing: border-box;
    }

    /* Clase que se activa al arrastrar */
    .layer-card.dragging {
        position: fixed !important;
        z-index: 999999 !important;
        opacity: 0.9;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        background-color: #383838;
        border: 1px solid #00bcd4;
        transition: none !important; /* Evita el teletransporte */
        pointer-events: none; /* Crucial para detectar dónde insertar abajo */
    }

    .layer-icon {
        margin-right: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-muted, #aaa);
    }
    .layer-icon .material-icons { font-size: 18px; }

    .layer-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        overflow: hidden;
        pointer-events: none;
    }

    .layer-name {
        font-size: 13px;
        color: var(--text-main, #e0e0e0);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .layer-meta {
        font-size: 10px;
        color: var(--text-muted, #888);
        font-family: monospace;
    }

    .layer-visibility {
        width: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-muted, #888);
        cursor: pointer;
    }
    .layer-visibility:hover { color: var(--text-main, #fff); }
    .layer-visibility .material-icons { font-size: 16px; }
    
    .layer-list::-webkit-scrollbar { width: 6px; }
    .layer-list::-webkit-scrollbar-thumb { background: var(--border-subtle, #555); border-radius: 3px; }
    .layer-list::-webkit-scrollbar-track { background: transparent; }
</style>

<div class="layer-list" id="layer-list-container">
    <div class="layer-card" style="opacity: 0.5;">
        <div class="layer-info"><div class="layer-name">Cargando...</div></div>
    </div>
</div>
