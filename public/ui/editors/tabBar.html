<window-config>
    <title>Tab Bar</title>
    <layout width="auto" height="32" x="0" y="38" />
    <behavior draggable="false" overlay="false" resizable="false" always-on-top="true" />
    <controls title="false" minimize="false" close="false" />
</window-config>

<style>
    /* * [IMPORTANTE] Transición suave para el Docking Dinámico.
     * Al tener el ID 'tab-bar' asignado por el WindowDOMBuilder,
     * podemos aplicar transición directamente al contenedor de la ventana.
     */
    #tab-bar.modular-window {
        transition: left 0.2s cubic-bezier(0.2, 0.8, 0.2, 1),
            width 0.2s cubic-bezier(0.2, 0.8, 0.2, 1);
        will-change: left, width;
    }

    .modular-window,
    .window-content {
        overflow: visible !important;
        background-color: transparent !important;
        box-shadow: none !important;
    }

    .tab-bar-container {
        display: flex;
        align-items: flex-end;
        width: 100%;
        height: 100%;
        background-color: var(--bg-header);
        border-bottom: 1px solid var(--border-subtle);
        padding-left: 0;
        box-sizing: border-box;
        overflow-x: auto;
        overflow-y: hidden;
    }

    /* Ocultar scrollbar */
    .tab-bar-container::-webkit-scrollbar {
        height: 0px;
        background: transparent;
    }

    .tab-item {
        display: flex;
        align-items: center;
        height: 100%;
        padding: 0 12px;
        min-width: 120px;
        max-width: 200px;
        background-color: transparent;
        border-right: 1px solid var(--border-subtle);
        color: var(--text-muted);
        font-family: 'Segoe UI', sans-serif;
        font-size: 12px;
        cursor: pointer;
        user-select: none;
        position: relative;
        transition: background 0.1s;
    }

    .tab-item:hover {
        background-color: var(--bg-hover);
        color: var(--text-main);
    }

    .tab-item.active {
        background-color: var(--bg-window);
        color: var(--accent-color);
        border-top: 2px solid var(--accent-color);
    }

    .tab-icon {
        font-size: 14px;
        margin-right: 6px;
        opacity: 0.7;
    }

    .tab-label {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        flex: 1;
    }

    .tab-close {
        margin-left: 8px;
        width: 16px;
        height: 16px;
        border-radius: 3px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        opacity: 0;
        transition: all 0.1s;
    }

    .tab-item:hover .tab-close {
        opacity: 0.7;
    }

    .tab-close:hover {
        background-color: #cc3333;
        color: white;
        opacity: 1;
    }
</style>

<div class="tab-bar-container" id="tabContainer">
    <div class="tab-item active">
        <span class="material-icons tab-icon">grid_on</span>
        <span class="tab-label">Stage 1</span>
        <span class="tab-close material-icons">close</span>
    </div>
    <div class="tab-item">
        <span class="material-icons tab-icon">accessibility</span>
        <span class="tab-label">Dad</span>
        <span class="tab-close material-icons">close</span>
    </div>
</div>

<script>
    (function () {
        const container = document.getElementById('tabContainer');
        if (!container) return;

        container.addEventListener('click', (e) => {
            const tab = e.target.closest('.tab-item');
            if (tab) {
                if (e.target.closest('.tab-close')) {
                    e.stopPropagation();
                    tab.remove();
                    return;
                }
                container.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
            }
        });
    })();
</script>